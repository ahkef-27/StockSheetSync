## 📈 株価管理ツール（Google スプレッドシート × Apps Script）

Google Apps Script と Google スプレッドシートを活用した、米国株価の自動取得・可視化ツールです。 ユーザーの手を煩わせることなく、リアルタイム株価の取得・変動率の色分け・日別＆週別のグラフ生成を自動で行います。

---

## 🛠 主な機能

    ✅ 米国市場の取引時間に合わせた自動取得（23:00〜5:00）

    ✅ AAPL / META / GOOGL の株価を定期取得

    ✅ 5%、10%の変動に応じたセルの色分け

    ✅ 取得失敗時のエラーハンドリング（グレー表示）

    ✅ 日別の株価推移グラフを自動生成

    ✅ 過去7日間の株価をまとめた週次グラフも自動生成

    ✅ 日付が変わると「本日株価」シートをリセットして新規記録

    ✅ 全シートに日付を自動挿入

    ✅ 視認性を高めるスタイル統一（フォントサイズ・行高・中央揃え）

---

## 📷 スクリーンショット（例）

    ※ここにスプレッドシートのスクリーンショットやグラフの画像を挿入すると効果的！

---

## 🚀 使い方

    Google スプレッドシートを作成

    Apps Script エディタを開き、本リポジトリのコードを貼り付け

    fetchDailyStockPrices() をトリガーに設定（例：15分ごと）

    トリガー設定後、次の区切り時間（例：23:00）まで待つと自動で動き出します！
        
(注意)

初回実行時、Googleから「このアプリは確認されていません」という警告が表示されることがあります。その場合は以下の手順でスクリプトの実行を許可してください：

①「詳細」をクリック

➁「（プロジェクト名）に移動」を選択

③自分のGoogleアカウントを選択

④アクセス権限を確認し、「許可」をクリック　で実行し直せばOK

※これは、GASプロジェクトがGoogleにより公開確認されていないために表示される標準の警告です。

---

## 💡 工夫したポイント

    市場時間の制御：米国市場の開場時間（23:00〜5:00）に限定してAPI呼び出しを最適化

    視覚的な工夫：変動率に応じた色分けで、株価の動きを直感的に把握可能

    エラー耐性：取得失敗時も処理が止まらず、視覚的に識別できる

    グラフの見やすさ：横長＆余白調整で、推移が一目でわかるように設計

    データの重複防止：同じ日付・時間帯のデータを上書きしないように工夫

    再利用性の高いコード構造：銘柄追加や期間変更も容易

---    

## 🧩 今後の改善点

2週間・1ヶ月のグラフ生成機能の追加

「本日株価」→「株価グラフ」の順にシート表示を整理

0:00〜0:30の取得で前日分が上書きされる問題の解消

ユーザーが任意の米国株銘柄を入力した際に、1日・1週間の株価推移グラフを自動生成する機能の追加

市場開場前（22:00〜22:29）の取得を制御し、誤データや誤差のあるグラフ生成を防ぐ

---

🔧 技術スタック

Google Apps Script（GAS）

Google スプレッドシート

GOOGLEFINANCE 関数

JavaScript（ES5ベース）

---

📌 注意点

    GOOGLEFINANCE 関数は一時的に取得失敗することがあります。再取得で回復する場合が多いです。

    トリガー設定後、すぐには動かないことがあります。次の実行タイミングまでお待ちください。
